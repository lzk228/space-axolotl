using Content.Client.Stylesheets;
using System.Numerics;
using Robust.Client.AutoGenerated;
using Robust.Client.Console;
using Robust.Client.UserInterface.CustomControls;
using Robust.Client.UserInterface.XAML;

namespace Content.Client.Administration.UI.CustomControls;

[GenerateTypedNameReferences]
public sealed partial class ConfirmWindow : DefaultWindow
{
    public event Action? OnDisposed;
    public string? Command { get; }

    public ConfirmWindow(string Command)
    {
        this.Command = Command;
        RobustXamlLoader.Load(this);
        IoCManager.InjectDependencies(this);

        Title = Loc.GetString("confirm-command-title", ("command", this.Command));

        ConfirmButton.AddStyleClass(StyleNano.StyleClassButtonColorRed);

        CancelButton.OnPressed += _ =>
        {
            Close();
        };
        ConfirmButton.OnPressed += _ =>
        {
            IoCManager.Resolve<IClientConsoleHost>().ExecuteCommand(this.Command);
            Close();
        };
    }

    protected override void Dispose(bool disposing)
    {
        OnDisposed?.Invoke();
        base.Dispose(disposing);
        OnDisposed = null;
    }
}
